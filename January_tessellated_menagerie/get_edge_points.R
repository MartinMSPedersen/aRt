library(imager)
library(tidyverse)

# Read and convert to grayscale if needed
x <- load.image("inputs/bear2.png")

#if needed
load.image("inputs/bear.png") %>% grayscale() -> x

#get edges of image
x %>% cannyEdges() -> x_edges

#convert logical to numerical
edge_mat <- drop(x_edges)
class(edge_mat) <- "array"
edge_mat <- edge_mat*1

#get points which are edges as dataframe
df <-
  x %>% 
  cannyEdges() %>% 
  as.cimg() %>% 
  as.data.frame() %>%
  filter(value == 1) %>%
  mutate(id = 1:nrow(.))

#get rid of some junk for later calc
data <-
  df %>%
  select(x, y)

#we can see these points define the border really well!
ggplot(data) +
  geom_point(aes(x = x, y = y), color = "black") +
  scale_y_reverse()

#save points
saveRDS(data, file = "bear.rds")
#now go to "select_points.R" shiny app to select your border points


######################################################################
#####here I've pasted the points from the select_points app
#####then you save them as an RDS file and import to tessellate script
#paste from app

sparse_points_giraffe <- 
  tibble::tribble(
    ~"",       ~"x",       ~"y",
    "\"5479\"",  "\"393\"",  "\"893\"",
    "\"5623\"",  "\"381\"",  "\"963\"",
    "\"5800\"",  "\"397\"", "\"1043\"",
    "\"6126\"",  "\"365\"", "\"1105\"",
    "\"6189\"",  "\"433\"", "\"1114\"",
    "\"7072\"",  "\"534\"", "\"1529\"",
    "\"7705\"",  "\"638\"", "\"1804\"",
    "\"8075\"",  "\"629\"", "\"1988\"",
    "\"8652\"",  "\"718\"", "\"2235\"",
    "\"9023\"",  "\"880\"", "\"2303\"",
    "\"8596\"", "\"1053\"", "\"2216\"",
    "\"7923\"", "\"1129\"", "\"1912\"",
    "\"7682\"", "\"1118\"", "\"1792\"",
    "\"6749\"", "\"1261\"", "\"1381\"",
    "\"6182\"", "\"1323\"", "\"1110\"",
    "\"6143\"", "\"1409\"", "\"1105\"",
    "\"5737\"", "\"1360\"", "\"1013\"",
    "\"5639\"", "\"1374\"",  "\"970\"",
    "\"5501\"", "\"1365\"",  "\"903\"",
    "\"4778\"", "\"1592\"",  "\"732\"",
    "\"2749\"", "\"1747\"",  "\"431\"",
    "\"2657\"", "\"1485\"",  "\"423\"",
    "\"3615\"", "\"1354\"",  "\"549\"",
    "\"4465\"", "\"1228\"",  "\"648\"",
    "\"2898\"", "\"1191\"",  "\"450\"",
    "\"1352\"", "\"1180\"",  "\"260\"",
    "\"575\"", "\"1207\"",   "\"70\"",
    "\"117\"", "\"1133\"",    "\"3\"",
    "\"759\"", "\"1000\"",  "\"115\"",
    "\"1484\"",  "\"991\"",  "\"291\"",
    "\"2036\"",  "\"884\"",  "\"389\"",
    "\"1609\"",  "\"777\"",  "\"321\"",
    "\"621\"",  "\"750\"",   "\"81\"",
    "\"16\"",  "\"643\"",    "\"2\"",
    "\"602\"",  "\"548\"",   "\"77\"",
    "\"1512\"",  "\"577\"",  "\"298\"",
    "\"3584\"",  "\"562\"",  "\"545\"",
    "\"4500\"",  "\"518\"",  "\"650\"",
    "\"2849\"",  "\"313\"",  "\"444\"",
    "\"2758\"",    "\"7\"",  "\"433\"",
    "\"3317\"",   "\"11\"",  "\"508\"",
    "\"4947\"",  "\"210\"",  "\"785\""
  )

sparse_points_stag <-
  tibble::tribble(
    ~V0,    ~V1,       ~V2,
      1,  797.6, 1774.8055,
      2,  672.2,  1695.061,
      3,  575.4, 1538.5255,
      4,  601.8,   1381.99,
      5,    648,  1252.036,
      6,  656.8,   1145.71,
      7,  634.8,  1110.268,
      8,  632.6, 1065.9655,
      9,  531.4, 1042.3375,
     10,    461,   944.872,
     11,  458.8,    850.36,
     12,  588.6,   897.616,
     13,  623.8,  953.7325,
     14,    637,   933.058,
     15,  531.4,  829.6855,
     16,  465.4,   779.476,
     17,  425.8,  711.5455,
     18,    340,   679.057,
     19,  271.8,   661.336,
     20,    219,  611.1265,
     21,  177.2,  563.8705,
     22,    252,  617.0335,
     23,  326.8,  628.8475,
     24,  265.2,  587.4985,
     25,    230,  487.0795,
     26,  225.6,   419.149,
     27,  243.2,  433.9165,
     28,  243.2,   478.219,
     29,  278.4,  552.0565,
     30,  280.6,   484.126,
     31,  269.6,  368.9395,
     32,  304.8,  233.0785,
     33,  335.6,  162.1945,
     34,  311.4,   301.009,
     35,  304.8,  410.2885,
     36,  346.6,  333.4975,
     37,  331.2,   448.684,
     38,    329,  516.6145,
     39,  355.4,  587.4985,
     40,  379.6,   501.847,
     41,  397.2,  428.0095,
     42,  467.6,   348.265,
     43,  432.4,    436.87,
     44,  403.8,  522.5215,
     45,  408.2,  575.6845,
     46,  443.4,  658.3825,
     47,  522.6,  746.9875,
     48,  551.2,  770.6155,
     49,  531.4,  670.1965,
     50,  562.2,   714.499,
     51,  577.6,   749.941,
     52,    604,  817.8715,
     53,    659,  829.6855,
     54,  698.6,   862.174,
     55,  733.8,   897.616,
     56,  738.2,   933.058,
     57,  760.2,  936.0115,
     58,  786.6,   938.965,
     59,  808.6,  936.0115,
     60,  819.6,  906.4765,
     61,  843.8,  876.9415,
     62,  953.8,  806.0575,
     63,   1011,  782.4295,
     64, 1035.2,  723.3595,
     65, 1061.6,  664.2895,
     66, 1070.4,   720.406,
     67, 1059.4,   755.848,
     68,   1066,   767.662,
     69, 1094.6,    732.22,
     70, 1125.4,   696.778,
     71, 1151.8,  587.4985,
     72, 1114.4,   531.382,
     73, 1070.4,  475.2655,
     74, 1079.2,   460.498,
     75, 1094.6,   490.033,
     76,   1121,  516.6145,
     77, 1138.6,  516.6145,
     78, 1156.2,  469.3585,
     79, 1136.4,  428.0095,
     80, 1114.4,   371.893,
     81, 1156.2,  416.1955,
     82, 1178.2,   490.033,
     83, 1195.8,  581.5915,
     84, 1228.8,  522.5215,
     85, 1233.2,   430.963,
     86, 1217.8,   371.893,
     87, 1206.8,   324.637,
     88, 1237.6,  380.7535,
     89, 1257.4,   419.149,
     90, 1244.2,  309.8695,
     91, 1222.2,  174.0085,
     92,   1264,    259.66,
     93, 1281.6,  357.1255,
     94,   1286,   419.149,
     95,   1286,  498.8935,
     96, 1279.4,    555.01,
     97, 1312.4,   501.847,
     98, 1314.6,    436.87,
     99, 1327.8,  428.0095,
    100, 1336.6,   460.498,
    101, 1323.4,  546.1495,
    102, 1288.2,  593.4055,
    103, 1244.2,   631.801,
    104, 1189.2,  699.7315,
    105, 1101.2,    791.29,
    106,  997.8,  847.4065,
    107,  947.2,  900.5695,
    108,  918.6,   927.151,
    109,  929.6,  947.8255,
    110,    956,  918.2905,
    111, 1096.8,   856.267,
    112, 1101.2,  924.1975,
    113, 1070.4, 1000.9885,
    114,    978,  1051.198,
    115,  929.6, 1060.0585,
    116,  920.8,  1092.547,
    117,    912,  1110.268,
    118,    912,   1145.71,
    119,  909.8, 1219.5475,
    120,    934,   1322.92,
    121,  973.6,  1429.246,
    122,  984.6, 1568.0605,
    123,  931.8, 1680.2935,
    124,  832.8,  1765.945
    )




sparse_points_longhorn <-
  tibble::tribble(
    ~V1,              ~V2,              ~V3,
     1L,            148.6, 233.366333333333,
     2L,            137.6, 232.790666666667,
     3L,            126.6,          218.399,
     4L, 125.133333333333, 203.431666666667,
     5L, 129.533333333333, 194.796666666667,
     6L, 129.533333333333, 185.298166666667,
     7L, 123.666666666667,         172.6335,
     8L, 116.333333333333,          157.954,
     9L, 112.666666666667,         148.4555,
    10L, 105.333333333333, 150.470333333333,
    11L,             89.2, 149.606833333333,
    12L, 81.1333333333333, 144.713666666667,
    13L, 77.4666666666666, 136.078666666667,
    14L, 87.7333333333333, 131.761166666667,
    15L, 89.9333333333333, 128.882833333333,
    16L, 77.4666666666666,          123.414,
    17L,             60.6,          109.598,
    18L,             51.8, 99.8116666666667,
    19L,             40.8, 92.9036666666667,
    20L,             23.2,          89.7375,
    21L, 9.26666666666667, 87.7226666666667,
    22L, 4.86666666666666, 83.1173333333333,
    23L, 5.59999999999999, 77.0728333333333,
    24L, 21.7333333333333, 75.6336666666667,
    25L, 32.7333333333333, 77.3606666666667,
    26L, 45.9333333333333, 80.8146666666667,
    27L, 56.9333333333333, 86.8591666666667,
    28L,             67.2, 92.0401666666667,
    29L,               76,          98.3725,
    30L, 85.5333333333333, 103.265666666667,
    31L, 98.7333333333333, 109.885833333333,
    32L,              109, 113.339833333333,
    33L,            115.6, 113.627666666667,
    34L, 121.466666666667, 108.446666666667,
    35L, 139.066666666667, 106.431833333333,
    36L, 162.533333333333,          106.144,
    37L, 178.666666666667, 108.446666666667,
    38L, 185.266666666667, 113.339833333333,
    39L, 188.933333333333,          114.779,
    40L, 195.533333333333,          113.052,
    41L, 206.533333333333, 108.158833333333,
    42L, 217.533333333333, 103.841333333333,
    43L, 228.533333333333, 97.2211666666667,
    44L, 241.733333333333,          89.7375,
    45L, 254.933333333333, 83.1173333333333,
    46L,            276.2, 79.0876666666666,
    47L, 294.533333333333,          81.1025,
    48L,            293.8,          84.5565,
    49L,            291.6, 90.3131666666667,
    50L,              274, 91.7523333333333,
    51L, 266.666666666667, 92.9036666666667,
    52L, 252.733333333333, 101.538666666667,
    53L, 239.533333333333, 109.022333333333,
    54L, 229.266666666667, 119.384333333333,
    55L,              219, 126.580166666667,
    56L, 210.933333333333,          130.322,
    57L, 210.933333333333, 133.200333333333,
    58L, 218.266666666667, 134.927333333333,
    59L, 222.666666666667, 140.971833333333,
    60L,              219, 146.440666666667,
    61L,            210.2,         150.1825,
    62L,            194.8, 150.758166666667,
    63L,              186,         148.4555,
    64L,            183.8, 153.924333333333,
    65L, 180.133333333333, 166.013333333333,
    66L, 172.066666666667, 180.980666666667,
    67L,            168.4, 187.025166666667,
    68L, 169.866666666667,         195.0845,
    69L,            172.8, 204.295166666667,
    70L, 172.066666666667, 216.384166666667,
    71L, 160.333333333333, 232.790666666667,
    72L, 151.533333333333, 232.790666666667
    )

dragonfly <- tibble::tribble(
               ~V0,    ~V1,              ~V2,
                 1,  313.6, 561.374666666667,
                 2, 307.44, 561.374666666667,
                 3, 298.64,         562.2345,
                 4,  300.4, 553.636166666667,
                 5, 295.12, 533.000166666667,
                 6, 289.84,          502.906,
                 7, 295.12, 493.447833333333,
                 8, 296.88,         459.0545,
                 9, 301.28, 416.922666666667,
                10, 303.04, 392.847333333333,
                11, 298.64, 382.529333333333,
                12, 299.52, 367.052333333333,
                13, 302.16, 360.173666666667,
                14, 301.28, 342.117166666667,
                15, 298.64, 331.799166666667,
                16, 299.52,          312.023,
                17, 299.52, 305.144333333333,
                18,  300.4, 282.788666666667,
                19, 297.76,         268.1715,
                20, 295.12, 256.133833333333,
                21,    296,          244.956,
                22, 297.76, 238.077333333333,
                23, 296.88,         232.0585,
                24,  291.6, 236.357666666667,
                25, 289.84,          244.956,
                26, 289.84, 250.974833333333,
                27, 289.84, 258.713333333333,
                28, 288.08,         273.3305,
                29, 288.08,         283.6485,
                30, 286.32, 287.087833333333,
                31, 270.48,          291.387,
                32, 246.72,         299.1255,
                33, 227.36,         304.2845,
                34, 179.84, 307.723833333333,
                35, 149.04, 303.424666666667,
                36,    120, 302.564833333333,
                37,  85.68, 298.265666666667,
                38,  52.24,         288.8075,
                39,  28.48, 276.769833333333,
                40,  13.52,          260.433,
                41,  25.84, 249.255166666667,
                42,  46.96, 238.937166666667,
                43,  73.36, 236.357666666667,
                44,  99.76, 232.918333333333,
                45, 127.04, 231.198666666667,
                46, 171.92, 233.778166666667,
                47, 206.24, 226.039666666667,
                48, 237.04,         221.7405,
                49, 222.96, 218.301166666667,
                50, 207.12, 218.301166666667,
                51, 182.48,          219.161,
                52, 157.84, 214.861833333333,
                53,  124.4,         206.2635,
                54,  96.24, 196.805333333333,
                55,   71.6, 182.188166666667,
                56,  43.44, 164.131666666667,
                57,  17.92,          146.935,
                58,  11.76, 128.018666666667,
                59,  17.92, 117.700666666667,
                60,  55.76,         113.4015,
                61,  94.48, 121.999833333333,
                62, 129.68, 133.177666666667,
                63, 156.96, 143.495666666667,
                64, 179.84, 148.654666666667,
                65, 205.36,         154.6735,
                66, 227.36,          162.412,
                67,  238.8,         164.9915,
                68, 231.76, 143.495666666667,
                69,  221.2, 138.336666666667,
                70, 219.44,          131.458,
                71, 224.72,          131.458,
                72, 237.92,         139.1965,
                73,  247.6, 165.851333333333,
                74, 266.08, 171.010333333333,
                75, 280.16, 169.290666666667,
                76, 283.68, 160.692333333333,
                77, 259.92, 148.654666666667,
                78, 255.52, 134.897333333333,
                79, 251.12,          115.981,
                80, 246.72, 103.943333333333,
                81, 241.44, 97.0646666666667,
                82, 244.96,          92.7655,
                83, 249.36, 97.0646666666667,
                84, 253.76,          105.663,
                85, 259.04, 116.840833333333,
                86, 264.32,         139.1965,
                87, 283.68,          152.094,
                88, 286.32, 152.953833333333,
                89, 299.52, 143.495666666667,
                90, 301.28, 135.757166666667,
                91, 290.72,         134.0375,
                92, 281.92,         134.0375,
                93, 279.28, 124.579333333333,
                94, 283.68,          115.981,
                95, 289.84, 112.541666666667,
                96, 294.24,         108.2425,
                97, 293.36, 96.2048333333333,
                98,  300.4, 106.522833333333,
                99, 308.32,         108.2425,
               100,    318,         108.2425,
               101, 325.92,           95.345,
               102, 323.28,         108.2425,
               103, 330.32, 115.121166666667,
               104, 336.48,         118.5605,
               105, 338.24, 133.177666666667,
               106, 334.72,         134.0375,
               107,  331.2, 135.757166666667,
               108,  322.4,         134.0375,
               109, 319.76,          136.617,
               110, 319.76, 142.635833333333,
               111, 332.08,         154.6735,
               112,  357.6, 142.635833333333,
               113, 359.36, 127.158833333333,
               114,    362, 114.261333333333,
               115, 365.52, 107.382666666667,
               116, 371.68, 99.6441666666666,
               117, 372.56,          92.7655,
               118, 377.84,           95.345,
               119, 376.96, 102.223666666667,
               120, 371.68, 109.962166666667,
               121, 368.16, 119.420333333333,
               122,  366.4,          131.458,
               123, 362.88, 146.075166666667,
               124, 336.48, 161.552166666667,
               125, 336.48, 168.430833333333,
               126, 347.92, 171.870166666667,
               127, 373.44, 166.711166666667,
               128, 377.84, 147.794833333333,
               129, 382.24,          141.776,
               130,  397.2, 133.177666666667,
               131, 400.72, 135.757166666667,
               132, 398.96, 138.336666666667,
               133, 393.68, 140.916166666667,
               134, 384.88,          146.935,
               135, 382.24,          162.412,
               136, 383.12,         164.9915,
               137, 408.64, 156.393166666667,
               138, 426.24, 153.813666666667,
               139, 457.04, 146.075166666667,
               140, 491.36, 135.757166666667,
               141, 525.68, 124.579333333333,
               142, 562.64, 117.700666666667,
               143, 589.92, 116.840833333333,
               144, 605.76, 125.439166666667,
               145,    604,          136.617,
               146, 594.32, 152.953833333333,
               147,    560,          177.889,
               148, 512.48, 201.964333333333,
               149, 481.68,          214.002,
               150, 437.68, 220.020833333333,
               151, 417.44, 220.020833333333,
               152, 394.56, 218.301166666667,
               153, 377.84, 217.441333333333,
               154, 394.56, 226.039666666667,
               155, 416.56,          229.479,
               156, 450.88, 235.497833333333,
               157,  498.4,          234.638,
               158,    538, 238.077333333333,
               159, 571.44,         242.3765,
               160, 594.32,         257.8535,
               161,  599.6, 266.451833333333,
               162, 587.28, 281.928833333333,
               163, 556.48, 294.826333333333,
               164, 522.16,          301.705,
               165, 483.44, 306.004166666667,
               166,  454.4,          306.864,
               167, 411.28, 307.723833333333,
               168, 383.12,         304.2845,
               169, 364.64, 298.265666666667,
               170, 350.56, 293.106666666667,
               171, 341.76,          291.387,
               172, 333.84, 289.667333333333,
               173, 332.08,         283.6485,
               174, 329.44, 266.451833333333,
               175,  326.8,         247.5355,
               176, 321.52, 233.778166666667,
               177, 318.88, 243.236333333333,
               178, 321.52, 251.834666666667,
               179, 320.64,         268.1715,
               180, 316.24,         278.4895,
               181, 314.48, 285.368166666667,
               182, 315.36, 294.826333333333,
               183, 316.24,          312.023,
               184, 317.12, 328.359833333333,
               185, 314.48,          337.818,
               186, 312.72,          353.295,
               187, 316.24, 365.332666666667,
               188, 316.24, 385.968666666667,
               189, 311.84, 391.127666666667,
               190,  313.6,         407.4645,
               191, 316.24, 424.661166666667,
               192, 315.36, 447.876666666667,
               193, 315.36, 473.671666666667,
               194,    318,         495.1675,
               195, 320.64, 507.205166666667,
               196, 318.88, 517.523166666667,
               197, 317.12, 526.981333333333,
               198, 315.36, 545.037833333333,
               199, 312.72, 552.776333333333,
               200, 314.48, 561.374666666667
               )


bear <- tibble::tribble(
          ~V0,              ~V1,      ~V2,
            1, 128.171428571429, 219.8836,
            2, 114.971428571429, 220.7372,
            3, 98.6285714285714, 220.3104,
            4, 86.0571428571428, 216.4692,
            5, 81.0285714285714, 208.7868,
            6, 82.2857142857143, 196.4096,
            7, 81.6571428571428, 190.0076,
            8, 77.8857142857143, 175.4964,
            9, 74.1142857142857, 169.5212,
           10, 59.6571428571428, 177.2036,
           11, 50.8571428571429, 190.4344,
           12, 52.1142857142857, 198.1168,
           13, 56.5142857142857,  204.092,
           14, 54.6285714285714, 215.6156,
           15,             40.8, 213.4816,
           16, 28.8571428571429, 201.1044,
           17, 21.9428571428571,  182.752,
           18,             23.2, 172.5088,
           19, 30.7428571428571, 161.8388,
           20, 37.0285714285714, 149.8884,
           21,             36.4, 134.5236,
           22, 33.2571428571429, 117.8784,
           23, 37.0285714285714, 100.3796,
           24, 47.7142857142857,  80.7468,
           25,             71.6,  61.9676,
           26, 106.171428571429,  47.8832,
           27, 123.142857142857,  47.4564,
           28, 167.142857142857,  50.0172,
           29, 180.342857142857,  50.8708,
           30, 193.542857142857,  47.8832,
           31, 214.914285714286,  47.4564,
           32,            238.8,  40.6276,
           33,            265.2,  32.0916,
           34, 276.514285714286,   29.104,
           35, 279.028571428571,  26.1164,
           36,            287.2,  28.6772,
           37, 293.485714285714,  30.3844,
           38, 307.942857142857,   29.104,
           39, 316.114285714286,  35.9328,
           40, 327.428571428571,  38.9204,
           41, 338.742857142857,  43.1884,
           42, 338.114285714286,  53.8584,
           43, 333.085714285714,   54.712,
           44,            326.8,  57.6996,
           45, 329.314285714286,  61.5408,
           46, 329.942857142857,  63.6748,
           47, 324.285714285714,  65.8088,
           48, 318.628571428571,  66.2356,
           49, 299.142857142857,  75.1984,
           50, 293.485714285714,  76.9056,
           51, 289.085714285714,  82.0272,
           52, 286.571428571429,  83.3076,
           53,            269.6,  89.7096,
           54, 250.114285714286, 100.8064,
           55, 248.857142857143, 109.3424,
           56, 245.085714285714, 125.5608,
           57, 232.514285714286, 138.7916,
           58, 224.342857142857, 145.1936,
           59, 220.571428571429, 158.4244,
           60, 219.314285714286, 173.3624,
           61, 220.571428571429, 187.8736,
           62, 220.571428571429, 194.7024,
           63, 226.857142857143, 200.2508,
           64, 240.057142857143, 202.8116,
           65, 245.085714285714, 204.5188,
           66, 248.857142857143, 211.3476,
           67, 248.228571428571, 213.9084,
           68, 237.542857142857, 215.6156,
           69, 219.942857142857, 215.6156,
           70, 211.142857142857, 215.1888,
           71, 199.828571428571, 213.9084,
           72, 195.428571428571, 210.0672,
           73, 192.914285714286, 200.6776,
           74,            190.4, 185.3128,
           75, 186.628571428571, 186.5932,
           76, 180.971428571429, 194.2756,
           77, 174.057142857143, 200.6776,
           78, 174.685714285714, 205.7992,
           79, 184.742857142857, 209.6404,
           80, 187.885714285714, 213.4816,
           81, 185.371428571429, 218.1764,
           82, 171.542857142857, 218.6032,
           83, 161.485714285714,  214.762,
           84, 153.314285714286, 210.0672,
           85, 148.914285714286, 199.3972,
           86, 149.542857142857, 190.4344,
           87,            159.6, 183.1788,
           88, 160.857142857143, 163.9728,
           89, 161.485714285714, 156.2904,
           90, 167.142857142857,  142.206,
           91,            172.8, 134.5236,
           92, 169.657142857143, 131.9628,
           93, 161.485714285714, 141.3524,
           94, 157.714285714286, 149.8884,
           95, 145.771428571429, 155.4368,
           96,            133.2, 158.4244,
           97, 121.257142857143,  157.144,
           98, 117.485714285714,  172.082,
           99, 113.085714285714, 184.4592,
          100, 114.971428571429,  193.422,
          101, 117.485714285714,  201.958,
          102, 126.914285714286,  206.226,
          103,            133.2, 211.7744,
          104,            133.2, 216.4692,
          105, 129.428571428571, 219.8836
          )

#clean up a bit and save as RDS
sparse_points2 <- bear %>%
  select(2:3) %>%
  #map_df(., ~readr::parse_number(.x)) %>%
  set_names(c("x", "y"))

ggplot(sparse_points2, aes(x,y)) +
  geom_polygon() +
  scale_y_reverse() +
  theme_void()

saveRDS(sparse_points2, "sparse_bear_points.rds")


####################**Recorded for posterity**############################
######I really hate to say goodbye to this, because I was proud that I  ##
######got it to work, but realistically interactive selection with shiny##
######just works better                                                 ##
##########################################################################
#but how do we order the points so that we can pass an ordered set to RTriangle?
#we basically need to solve the travelling salesman problem
#find the shortest path between points w/o visiting any point twice
#this should define the border

###solve TSP###
#we actually find the shortest Hamilton path b/c pure TSP gives a weird line at the end
#when it tries to connect the final point to the original... idk why 
#insert dummy pt to make the problem Hamilton (ELIZAAAAA!)
library(TSP)
tsp <- TSP(dist(data)) 
tsp <- insert_dummy(tsp, label = "cut")

#you might have to iterate this a couple times to get a smooth TSP solution without rando lines
solve_TSP(tsp, method = "arbitrary_insertion", control = "two_opt") %>% 
  as.integer() -> solution

# Rearrange the original points according the TSP output
data_to_plot <- data[solution,]

#it works!
ggplot(data_to_plot, aes(x,y)) +
  geom_path() +
  scale_y_reverse() +
  theme_void()

#later on figure out best way to sample points to make more sparse
#random sample
set.seed(123)
points_sparse <- 
  data_to_plot %>%
  tibble::rowid_to_column("id") %>%
  sample_n(100) %>%
  arrange(id)

ggplot(points_sparse) +
  geom_point(aes(x = x, y = y), color = "black") +
  scale_y_reverse()
ggplot(points_sparse, aes(x,y)) +
  geom_path() +
  scale_y_reverse() +
  theme_void()

#that doesn't work

#I think it's better to just do interactive selection w/ Shiny
#use nearPoints() function in Shiny app
#saveRDS(data_to_plot, file = "stag_arranged.rds")